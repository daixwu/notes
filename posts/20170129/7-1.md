# Array æ•°ç»„çš„æ“ä½œ

## æ‰©å±•è¿ç®—ç¬¦

æ‰©å±•è¿ç®—ç¬¦ï¼ˆspreadï¼‰æ˜¯ä¸‰ä¸ªç‚¹ï¼ˆ`...`ï¼‰ã€‚å®ƒå¥½æ¯” rest å‚æ•°çš„é€†è¿ç®—ï¼Œå°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ã€‚

è¯¥è¿ç®—ç¬¦ä¸»è¦ç”¨äºå‡½æ•°è°ƒç”¨ã€‚

```js
function push(array, ...items) {
  array.push(...items);
}

function add(x, y) {
  return x + y;
}

const numbers = [4, 38];
add(...numbers); // 42
```

ä¸Šé¢ä»£ç ä¸­ï¼Œ`array.push(...items)`å’Œ`add(...numbers)`è¿™ä¸¤è¡Œï¼Œéƒ½æ˜¯å‡½æ•°çš„è°ƒç”¨ï¼Œå®ƒä»¬çš„éƒ½ä½¿ç”¨äº†æ‰©å±•è¿ç®—ç¬¦ã€‚è¯¥è¿ç®—ç¬¦å°†ä¸€ä¸ªæ•°ç»„ï¼Œå˜ä¸ºå‚æ•°åºåˆ—ã€‚

æ‰©å±•è¿ç®—ç¬¦ä¸æ­£å¸¸çš„å‡½æ•°å‚æ•°å¯ä»¥ç»“åˆä½¿ç”¨ï¼Œéå¸¸çµæ´»ã€‚

```js
function f(v, w, x, y, z) {}
const args = [0, 1];
f(-1, ...args, 2, ...[3]);
```

æ‰©å±•è¿ç®—ç¬¦åé¢è¿˜å¯ä»¥æ”¾ç½®è¡¨è¾¾å¼ã€‚

```js
const arr = [...(x > 0 ? ["a"] : []), "b"];
```

æ³¨æ„ï¼Œåªæœ‰å‡½æ•°è°ƒç”¨æ—¶ï¼Œæ‰©å±•è¿ç®—ç¬¦æ‰å¯ä»¥æ”¾åœ¨åœ†æ‹¬å·ä¸­ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

```js
(...[1, 2])
// Uncaught SyntaxError: Unexpected number

console.log((...[1, 2]))
// Uncaught SyntaxError: Unexpected number

console.log(...[1, 2])
// 1 2
```

### æ›¿ä»£å‡½æ•°çš„ apply æ–¹æ³•

ç”±äºæ‰©å±•è¿ç®—ç¬¦å¯ä»¥å±•å¼€æ•°ç»„ï¼Œæ‰€ä»¥ä¸å†éœ€è¦`apply`æ–¹æ³•ï¼Œå°†æ•°ç»„è½¬ä¸ºå‡½æ•°çš„å‚æ•°äº†ã€‚

```js
// ES5 çš„å†™æ³•
function f(x, y, z) {
  // ...
}
var args = [0, 1, 2];
f.apply(null, args);

// ES6çš„å†™æ³•
function f(x, y, z) {
  // ...
}
let args = [0, 1, 2];
f(...args);
```

åº”ç”¨`Math.max`æ–¹æ³•ï¼Œç®€åŒ–æ±‚å‡ºä¸€ä¸ªæ•°ç»„æœ€å¤§å…ƒç´ çš„å†™æ³•

```js
// ES5 çš„å†™æ³•
Math.max.apply(null, [14, 3, 77]);

// ES6 çš„å†™æ³•
Math.max(...[14, 3, 77]);

// ç­‰åŒäº
Math.max(14, 3, 77);
```

å°†ä¸€ä¸ªæ•°ç»„æ·»åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„çš„å°¾éƒ¨

```js
// ES5çš„ å†™æ³•
var arr1 = [0, 1, 2];
var arr2 = [3, 4, 5];
Array.prototype.push.apply(arr1, arr2);

// ES6 çš„å†™æ³•
let arr1 = [0, 1, 2];
let arr2 = [3, 4, 5];
arr1.push(...arr2);
```

### æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨

#### å¤åˆ¶æ•°ç»„

æ•°ç»„æ˜¯å¤åˆçš„æ•°æ®ç±»å‹ï¼Œç›´æ¥å¤åˆ¶çš„è¯ï¼Œåªæ˜¯å¤åˆ¶äº†æŒ‡å‘åº•å±‚æ•°æ®ç»“æ„çš„æŒ‡é’ˆï¼Œè€Œä¸æ˜¯å…‹éš†ä¸€ä¸ªå…¨æ–°çš„æ•°ç»„ã€‚

```js
const a1 = [1, 2];
const a2 = a1;

a2[0] = 2;
a1; // [2, 2]
```

ä¸Šé¢ä»£ç ä¸­ï¼Œa2 å¹¶ä¸æ˜¯ a1 çš„å…‹éš†ï¼Œè€Œæ˜¯æŒ‡å‘åŒä¸€ä»½æ•°æ®çš„å¦ä¸€ä¸ªæŒ‡é’ˆã€‚ä¿®æ”¹ a2ï¼Œä¼šç›´æ¥å¯¼è‡´ a1 çš„å˜åŒ–ã€‚

ES5 åªèƒ½ç”¨å˜é€šæ–¹æ³•æ¥å¤åˆ¶æ•°ç»„ã€‚

```js
const a1 = [1, 2];
const a2 = a1.concat();

a2[0] = 2;
a1; // [1, 2]
```

ä¸Šé¢ä»£ç ä¸­ï¼Œa1 ä¼šè¿”å›åŸæ•°ç»„çš„å…‹éš†ï¼Œå†ä¿®æ”¹ a2 å°±ä¸ä¼šå¯¹ a1 äº§ç”Ÿå½±å“ã€‚

æ‰©å±•è¿ç®—ç¬¦æä¾›äº†å¤åˆ¶æ•°ç»„çš„ç®€ä¾¿å†™æ³•ã€‚

```js
const a1 = [1, 2];
// å†™æ³•ä¸€
const a2 = [...a1];
// å†™æ³•äºŒ
const [...a2] = a1;
```

ä¸Šé¢çš„ä¸¤ç§å†™æ³•ï¼Œa2 éƒ½æ˜¯ a1 çš„å…‹éš†ã€‚

#### åˆå¹¶æ•°ç»„

æ‰©å±•è¿ç®—ç¬¦æä¾›äº†æ•°ç»„åˆå¹¶çš„æ–°å†™æ³•ã€‚

```js
const arr1 = ["a", "b"];
const arr2 = ["c"];
const arr3 = ["d", "e"];

// ES5 çš„åˆå¹¶æ•°ç»„
arr1.concat(arr2, arr3);
// [ 'a', 'b', 'c', 'd', 'e' ]

// ES6 çš„åˆå¹¶æ•°ç»„
[...arr1, ...arr2, ...arr3];
// [ 'a', 'b', 'c', 'd', 'e' ]
```

ä¸è¿‡ï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½æ˜¯æµ…æ‹·è´ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ã€‚

```js
const a1 = [{ foo: 1 }];
const a2 = [{ bar: 2 }];

const a3 = a1.concat(a2);
const a4 = [...a1, ...a2];

a3[0] === a1[0]; // true
a4[0] === a1[0]; // true
```

ä¸Šé¢ä»£ç ä¸­ï¼Œa3 å’Œ a4 æ˜¯ç”¨ä¸¤ç§ä¸åŒæ–¹æ³•åˆå¹¶è€Œæˆçš„æ–°æ•°ç»„ï¼Œä½†æ˜¯å®ƒä»¬çš„æˆå‘˜éƒ½æ˜¯å¯¹åŸæ•°ç»„æˆå‘˜çš„å¼•ç”¨ï¼Œè¿™å°±æ˜¯æµ…æ‹·è´ã€‚å¦‚æœä¿®æ”¹äº†åŸæ•°ç»„çš„æˆå‘˜ï¼Œä¼šåŒæ­¥åæ˜ åˆ°æ–°æ•°ç»„ã€‚

#### ä¸è§£æ„èµ‹å€¼ç»“åˆ

æ‰©å±•è¿ç®—ç¬¦å¯ä»¥ä¸è§£æ„èµ‹å€¼ç»“åˆèµ·æ¥ï¼Œç”¨äºç”Ÿæˆæ•°ç»„ã€‚

```js
// ES5
a = list[0], rest = list.slice(1)
// ES6
[a, ...rest] = list
```

ä¸‹é¢æ˜¯å¦å¤–ä¸€äº›ä¾‹å­ã€‚

```js
const [first, ...rest] = [1, 2, 3, 4, 5];
first; // 1
rest; // [2, 3, 4, 5]

const [first, ...rest] = [];
first; // undefined
rest; // []

const [first, ...rest] = ["foo"];
first; // "foo"
rest; // []
```

å¦‚æœå°†æ‰©å±•è¿ç®—ç¬¦ç”¨äºæ•°ç»„èµ‹å€¼ï¼Œåªèƒ½æ”¾åœ¨å‚æ•°çš„æœ€åä¸€ä½ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

```js
const [...butLast, last] = [1, 2, 3, 4, 5];
// æŠ¥é”™

const [first, ...middle, last] = [1, 2, 3, 4, 5];
// æŠ¥é”™
```

#### å­—ç¬¦ä¸²

æ‰©å±•è¿ç®—ç¬¦è¿˜å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚

```js
[..."hello"];
// [ "h", "e", "l", "l", "o" ]
```

ä¸Šé¢çš„å†™æ³•ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„å¥½å¤„ï¼Œé‚£å°±æ˜¯èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«å››ä¸ªå­—èŠ‚çš„ Unicode å­—ç¬¦ã€‚

#### å®ç°äº† Iterator æ¥å£çš„å¯¹è±¡

ä»»ä½•å®šä¹‰äº†éå†å™¨ï¼ˆIteratorï¼‰æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨æ‰©å±•è¿ç®—ç¬¦è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚

```js
let nodeList = document.querySelectorAll("div");
let array = [...nodeList];
```

[ğŸ”—å‚è§](http://es6.ruanyifeng.com/#docs/array)
